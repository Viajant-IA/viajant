<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Chat - Viajant</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
        padding: 20px;
      }
      #chat {
        border: 1px solid #ccc;
        padding: 10px;
        height: 300px;
        overflow-y: auto;
      }
      #input {
        width: 80%;
      }

      #send {
        background-color: rgb(79, 74, 221);
        border-radius: 30px;
        padding: 15px 30px;
        border: none;
        cursor: pointer;
        transition: transform 0.2s, background-color 0.2s;
        color: #f0f0f0;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div id="chat"></div>
    <input type="text" id="input" placeholder="Digite sua mensagem" />
    <button id="send">Enviar</button>
    <h6>Viajant pode cometer erros.</h6>
    <script>
      import OpenAI from "openai";

      const chatDiv = document.getElementById("chat");
      const input = document.getElementById("input");
      const send = document.getElementById("send");

      // --- INSTRUÃ‡Ã•ES DA IA --- //
      const instructions =
        "VocÃª Ã© uma IA que planeja roteiro de viagens para os usuÃ¡rios, o seu nome serÃ¡ Viajant.";

      send.addEventListener("click", async () => {
        const msg = input.value.trim();
        if (!msg) return;

        chatDiv.innerHTML += `<p><b>VocÃª:</b> ${msg}</p>`;
        input.value = "";

        try {
          const res = await fetch("/api/chat", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ message: msg }),
          });

          const data = await res.json();
          console.log(data); // ðŸ‘ˆ mostra no console
          const gptMsg =
            data?.choices?.[0]?.message?.content || "Sem resposta ðŸ˜…";
          chatDiv.innerHTML += `<p><b>Viajant:</b> ${gptMsg}</p>`;
        } catch (err) {
          console.error("Erro no chat:", err);
          chatDiv.innerHTML += `<p style='color:red'>Erro: ${err}</p>`;
        }
      });
    </script>
  </body>
</html>
